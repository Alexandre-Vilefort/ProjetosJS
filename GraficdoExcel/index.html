<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="pt-br">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Trabalho Roland</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="https://site.fatecfranca.edu.br/templates/f109-2017/favicon.ico">
    <link rel="shortcut icon" href="https://site.fatecfranca.edu.br/templates/f109-2017/favicon.ico">

    <!--Bibliotecas-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/pixeden-stroke-7-icon@1.2.3/pe-icon-7-stroke/dist/pe-icon-7-stroke.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.0/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->
    <link href="https://cdn.jsdelivr.net/npm/chartist@0.11.0/dist/chartist.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/jqvmap@1.5.1/dist/jqvmap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/weathericons@2.1.0/css/weather-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.css" rel="stylesheet" />

    <style>
        input[type="file"] {
            display: none;
        }

        #weatherWidget .currentDesc {
            color: #ffffff !important;
        }

        .traffic-chart {
            min-height: 335px;
        }

        #flotPie1 {
            height: 150px;
        }

        #flotPie1 td {
            padding: 3px;
        }

        #flotPie1 table {
            top: 20px !important;
            right: -10px !important;
        }

        .chart-container {
            display: table;
            min-width: 270px;
            text-align: left;
            padding-top: 10px;
            padding-bottom: 10px;
        }

        #flotLine5 {
            height: 105px;
        }

        #flotBarChart {
            height: 150px;
        }

        #cellPaiChart {
            height: 160px;
        }

        /*CSS adicionado para o Trabalho do Roland*/

        #facaUpload {
            color: #41434d;

        }

        #cardChecker .form-check>input {
            display: inline-block;
            color: #03a9f3;
            font-size: 20px;
            padding: 10px 0;
            position: relative;
        }

        #cardChecker .form-check>label {
            display: inline-block;
            color: #41434d;
            font-size: 20px;
            padding: 10px 0;
            position: relative;
        }

        .navbar .navbar-nav li>label {
            background: none !important;
            color: #03a9f3;
            display: inline-block;
            font-size: 14px;
            line-height: 26px;
            padding: 10px 0;
            position: relative;
            width: 100%;
        }

        .navbar .navbar-nav li>label:hover .menu-icon {
            color: #41434d;
        }

        .navbar .navbar-nav li>label:hover {
            color: #41434d;
        }


        .navbar .navbar-nav li>label .menu-icon {
            color: #03a9f3;
            float: left;
            margin-top: 8px;
            width: 55px;
            text-align: left;
            z-index: 9;
        }

        .open aside.left-panel .navbar .navbar-nav li label {
            font-size: 0;
            z-index: 0;
            -webkit-transition: none;
            transition: none;
        }

        .open aside.left-panel .navbar .navbar-nav li label .menu-icon {
            font-size: 20px;
            z-index: -1;
            text-align: center;
            width: inherit;
        }
    </style>
</head>

<body>
    <!-- Left Panel -->
    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">
            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <label class="custom-file-upload">
                            <i class="menu-icon fa fa-upload" id="teste"></i>
                            <input id="fileUpload" type="file" accept=".xls,.xlsx" />
                            </i>Fazer UpLoad
                        </label>
                        <!-- <a href="index.html"><i class="menu-icon fa fa-laptop"></i>Dashboard </a>-->
                    </li>
                    <li class="menu-title">Menu</li><!-- /.menu-title -->
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"> <i class="menu-icon fa fa-cog"></i>Questões</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-check-square"></i><a id="selQuest">Selecionar</a></li>
                            <!--<li><i class="fa  fa-cogs"></i><a>Modificar Gráficos</a></li>-->
                        </ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"> <i class="menu-icon fa fa-table"></i>Períodos</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-id-badge"></i><a id="selMatutino">Matutino</a></li>
                            <li><i class="fa fa-id-badge"></i><a id="selNoturno">Noturno</a></li>
                            <li><i class="fa fa-id-badge"></i><a id="selTodas">Todas os períodos</a></li>
                        </ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"> <i class="menu-icon fa fa-th"></i>Cursos</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="menu-icon fa fa-plus-square-o"></i><a id="ADS">ADS</a></li>
                            <li><i class="menu-icon fa fa-plus-square-o"></i><a id="DSM">
                                    DSM</a></li>
                            <li><i class="menu-icon fa fa-plus-square-o"></i><a id="GPI">GPI</a></li>
                            <li><i class="menu-icon fa fa-plus-square-o"></i><a id="GRH">GRH</a></li>
                            <li><i class="menu-icon fa fa-plus-square-o"></i><a id="todosCursos">Todos os cursos</a>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside>
    <!-- /#left-panel -->
    <!-- Right Panel -->
    <div id="right-panel" class="right-panel">
        <!-- Header-->
        <header id="header" class="header bg-danger">
            <div class="top-left bg-danger">
                <div class="navbar-header bg-danger">
                    <a class="navbar-brand"><img
                            src="images/fatec-logo.png" width="50%"
                            height="50%" alt="Logo"></a>
                    <a class="navbar-brand hidden"><img src="images/fatec-logo.png" alt="Logo" width="50%"
                        height="50%"></a>
                    <a id="menuToggle" class="menutoggle"><i class="fa fa-bars"></i></a>
                </div>
            </div>
            <div class="nav justify-content-end">
                <img class="" src="images/logo-cps.png" width="80" height="54">
            </div>
            <div class="top-right">
                <div class="header-menu">
                </div>
            </div>
        </header>
        <!-- /#header -->
        <!-- Content -->
        <div class="content">
            <!-- Animated -->
            <div class="animated fadeIn">
                <!-- Widgets  -->
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-3">
                                        <i class="pe-7s-browser"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span id="spanTotalPerguntas" class="count"></span>
                                            </div>
                                            <div class="stat-heading">Total de perguntas</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-4">
                                        <i class="pe-7s-users"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span id="spanTotalAlunos" class="count"></span>
                                            </div>
                                            <div class="stat-heading">Alunos na pesquisa</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Widgets -->
                <!--  Traffic  -->
                <div id="divChart" class="row">
                </div>
                <!--  /Traffic -->
                <div class="clearfix"></div>
                <!-- Orders -->
                <div class="orders">
                    <div class="row">
                        <div class="col-lg-12 col-md-10">
                            <div class="card ov-h">
                                <div class="card-body">
                                    <div id="flotBarChart" class="float-chart ml-4 mr-4">
                                        <h3 id="facaUpload">Faça Upload da planilha</h1>
                                    </div>
                                </div>
                                <div id="cellPaiChart" class="float-chart"></div>
                            </div><!-- /.card -->
                        </div> <!-- /.col-lg-8 -->

                    </div>
                </div>
                <!-- /Calender Chart Weather -->
                <!-- Modal - Calendar - Add New Event -->
                <div class="modal fade none-border" id="event-modal">

                </div>
            </div>
            <!-- .animated -->
        </div>
        <!-- /.content -->
        <div class="clearfix"></div>
        <!-- Footer -->
        <footer class="site-footer">
            <div class="footer-inner bg-white">
                <div class="row">
                    <div class="col-sm-6">
                        Copyright &copy; 2018 Ela Admin
                    </div>
                    <div class="col-sm-6 text-right">
                        Designed by <a href="https://github.com/Alexandre-Vilefort/ProjetosJS">Alexandre Vilefort</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- /.site-footer -->
    </div>
    <!-- /#right-panel -->

    <!-- Scripts -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"></script>
    <script type="text/javascript" src="assets/js/xlx2json.js"></script>
    <!--Cria arquivo em JSON -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
    <script src="assets/js/main.js"></script>

    <!--  Chart js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.7.3/dist/Chart.bundle.min.js"></script>

    <!--Chartist Chart-->
    <script src="https://cdn.jsdelivr.net/npm/chartist@0.11.0/dist/chartist.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartist-plugin-legend@0.6.2/chartist-plugin-legend.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery.flot@0.8.3/jquery.flot.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flot-pie@1.0.0/src/jquery.flot.pie.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flot-spline@0.0.1/js/jquery.flot.spline.min.js"></script>

    <!--Weather-->
    <script src="https://cdn.jsdelivr.net/npm/simpleweather@3.1.0/jquery.simpleWeather.min.js"></script>
    <script src="assets/js/init/weather-init.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.js"></script>
    <script src="assets/js/init/fullcalendar-init.js"></script>

    <!--Bibliotecas para o Data table-->
    <!--<script src="https://code.jquery.com/jquery-3.5.1.js"></script>-->
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>

    <!--Local Stuff-->
    <script>
        //Colors
        var setColors = ['rgba(255, 99, 132, 0.8)',
            'rgba(54, 162, 235, 0.8)',
            'rgba(255, 206, 86, 0.8)',
            'rgba(75, 192, 192, 0.8)',
            'rgba(153, 102, 255, 0.8)',
            'rgba(255, 159, 64, 0.8)',
            'rgba(139, 0, 0, 0.8)',
            'rgba(72, 61, 139, 0.8)',
            'rgba(0, 206, 209, 0.8)',
            'rgba(0, 191, 255, 0.8)',
            'rgba(34, 139, 34, 0.8)',
            'rgba(173, 255, 47, 0.8)',
            'rgba(205, 92, 92, 0.8)',
            'rgba(240, 230, 140, 0.8)',
            'rgba(240, 128, 128, 0.8)',
            'rgba(211, 211, 211, 0.8)',
            'rgba(255, 182, 193, 0.8)',
            'rgba(135, 206, 250, 0.8)',
            'rgba(176, 196, 222, 0.8)',
            'rgba(186, 85, 211, 0.8)',
            'rgba(0, 0, 128, 0.8)',
            'rgba(244, 164, 96, 0.8)',
        ];
        var colorBlue = "rgba(4, 73, 203,0.9)";

        var questionClass = "nenhuma";
        var tableAllAnswerSet = [];//Variável para caso seja tabela e crie gráfico auxiliar
        var tableAllAnswerCounter = [];
        var tableAllAnswer = [];

        document
            .getElementById("selMatutino")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Matutino");
                createGraphs();
            });

        document
            .getElementById("selNoturno")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Noturno");
                createGraphs();
            });

        document
            .getElementById("selTodas")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                createGraphs();
            });

        document
            .getElementById("ADS")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Análise e Desenvolvimento de Sistemas (ADS)");
                createGraphs();
            });

        document
            .getElementById("DSM")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Desenvolvimento de Software Multiplataforma");
                createGraphs();
            });

        document
            .getElementById("GPI")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Gestão da Produção Industrial");
                createGraphs();
            });

        document
            .getElementById("GRH")
            .addEventListener("click", function () {
                createAnswer();
                createSetCounter();
                filterData("Gestão de Recursos Humanos");
                createGraphs();
            });

        document
            .getElementById("selQuest")
            .addEventListener("click", function () {
                console.log("entron no selQuest")
                document.getElementById('divChart').innerHTML = "";
                //Criar CheckBox para escolher quais Questões irão aparecer

                document.getElementById('divChart').innerHTML = `<div class="card col-lg-12">
                                                                <div id="cardChecker" class="card-body col-lg-12">
                                                                </div></div>`;

                for (let i = 1; i < question.length; i++) {
                    var insertDiv = document.createElement('div');
                    insertDiv.setAttribute('class', 'form-check col-lg-12');

                    insertDiv.innerHTML = `<input
                                        class="form-check-input"
                                        type="checkbox"
                                        value=""
                                        id="Check${question[i]}"
                                        />
                                        <label class="form-check-label" for="flexCheckDefault">
                                        ${question[i]}
                                        </label>`;

                    document.getElementById('cardChecker').append(insertDiv);
                }

                //flotBarChart
                var insertBtn1 = document.createElement('button')
                insertBtn1.setAttribute('class', 'btn btn-outline-primary btnCheck');
                insertBtn1.setAttribute('onclick', 'btnCheckerFunction()');
                insertBtn1.innerHTML = "Gerar Gráficos";
                insertBtn1.style.margin = "25px";
                insertBtn1.style.fontSize = "20px";
                document.getElementById('cardChecker').append(insertBtn1);

                var insertBtn2 = document.createElement('button')
                insertBtn2.setAttribute('class', 'btn btn-outline-primary btnCheck');
                insertBtn2.setAttribute('onclick', 'btnCheckerFunction()');
                insertBtn2.innerHTML = "Gerar Gráficos";
                insertBtn2.style.margin = "25px";
                insertBtn2.style.fontSize = "20px";
                document.getElementById('cardChecker').prepend(insertBtn2);

            });

        function btnCheckerFunction() {

            for (let i = 1; i < question.length; i++) {
                checkList[i] = document.getElementById(`Check${question[i]}`).checked;
            }
            createGraphs();

        }

        function createQuestionGraph(nameGraph, q, graphType) {
            questionClass = "nenhuma";
            tableAllAnswerSet = [];//Variável para caso seja tabela e crie gráfico auxiliar
            tableAllAnswerCounter = [];
            tableAllAnswer = [];

            console.log(nameGraph);
            var insertDiv = document.createElement('div');
            insertDiv.setAttribute('class', 'col-lg-12');

            insertDiv.innerHTML = `
                            <div class="card">
                            <div class="card-body">
                                <h4 id="titleGraph${nameGraph}" class="box-title" >${question[q]}</h4>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div id="divCanvas${nameGraph}" class="card-body">
                                    
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div id="${nameGraph}progress" class="card-body">
                                        <div id="divCanvasAux${nameGraph}"></div>
                                    </div> <!-- /.card-body -->
                                </div>
                            </div> <!-- /.row -->
                            <div class="card-body"></div>
                        </div><!-- /# column -->`;

            document.getElementById('divChart').appendChild(insertDiv);

            //Decidir como será mostrada os Resultados
            //questionClass = "nd";//Tem scopo fora dessa função
            var answerSet;//Variável para gráficos tipo Data
            var answerSet;
            var counter;
            if ((question[q].toLowerCase()).indexOf("escreva algumas linhas") >= 0) {
                questionClass = "aberta";
                answerList = answer[q];
                createTable(nameGraph, answerList);

            } else if ((question[q].toLowerCase()).indexOf("tempo de moradia") >= 0) {//pegar a questão que está dando problema

                let chartDataset = createDataset(setAnswer[q], question[q], answerCounter[q]);
                questionClass = "num";
                createChartjs(nameGraph, chartDataset, 'line');

            } else if (setAnswer[q].length < dataQuest.length / 6) {
                questionClass = "nd";
                let chartDataset = createDataset(setAnswer[q], question[q], answerCounter[q]);
                if (graphType.toLowerCase() === "auto") {
                    if (setAnswer[q].length > 4) {
                        graphType = "bar";
                    } else {
                        graphType = "pie";
                    }
                }
                if (typeof setAnswer[q][1] === 'number') {
                    questionClass = "num";
                }
                createChartjs(nameGraph, chartDataset, graphType);
            } else {
                answerList = new Array(answer[q].length);
                if (question[q].indexOf("data") >= 0) {
                    for (let i = 0; i < answer[q].length; i++) {
                        let dataTemp = ExcelDateToJSDate(answer[q][i]);
                        answerList[i] = "";
                        answerList[i] = (dataTemp.getFullYear()).toString();
                        //Arrumar para answerCounter contar as respostas
                    }
                    answerList.sort(function (a, b) { return a - b });
                    answerSet = [...new Set(answerList)];
                    counter = new Array(answerSet.length);
                    for (let j = 0; j < counter.length; j++) {
                        counter[j] = 0;
                    }
                    for (let i = 0; i < answerList.length; i++) {
                        for (let j = 0; j < counter.length; j++) {
                            if (answerList[i] == answerSet[j]) {
                                counter[j] += 1;
                            }
                        }
                    }
                    let chartDataset = createDataset(answerSet, question[q], counter);
                    createChartjs(nameGraph, chartDataset, "bar");
                    questionClass = "data";
                } else if (question[q].indexOf("RA") >= 0) {
                    //teste
                    answerList = answer[q];
                    createTable(nameGraph, answerList);
                } else {
                    answerList = answer[q];
                    createTable(nameGraph, answerList);
                }

            }
            //Contas para gerar as barras ao lado do gráfico
            //Achar o maior valor

            var titleProgressBar1 = "";
            var titleProgressBar2 = "";
            var textProgressBar1 = "";
            var textProgressBar2 = "";
            var progressPorcen1 = 0;
            var progressPorcen2 = 0;

            if (questionClass === "nd") {
                var gValue = -1;
                var mValue = 1000;
                var gIndice = -1;
                var mIndice = -1;
                for (let i = 0; i < answerCounter[q].length; i++) {
                    if (answerCounter[q][i] > gValue) {
                        gValue = answerCounter[q][i];
                        gIndice = i;
                    }
                    if (answerCounter[q][i] < mValue) {
                        mValue = answerCounter[q][i];
                        mIndice = i;
                    }
                }

                var porcentG = answerCounter[q][gIndice] / answer[q].length * 100;
                var porcentM = answerCounter[q][mIndice] / answer[q].length * 100;

                titleProgressBar1 = `Mais respondido: ${setAnswer[q][gIndice]}`;
                titleProgressBar2 = `Menos respondido: ${setAnswer[q][mIndice]}`;
                textProgressBar1 = `${answerCounter[q][gIndice]} Alunos (${porcentG.toFixed(2)}%)`;
                textProgressBar2 = `${answerCounter[q][mIndice]} Alunos (${porcentM.toFixed(2)}%)`;
                progressPorcen1 = porcentG.toFixed(2);
                progressPorcen2 = porcentM.toFixed(2);
            } else if (questionClass === "data") {

                var gValue = -1;
                var mValue = 10000000000000;
                var gIndice = -1;
                var mIndice = -1;

                for (let i = 0; i < counter.length; i++) {
                    if (Number(counter[i]) > gValue) {
                        gValue = counter[i];
                        gIndice = i;
                        console.log("teste gIndice " + gIndice)
                    }
                    if (counter[i] < mValue) {
                        mValue = counter[i];
                        mIndice = i;
                    }
                }
                var media = 0;
                var sum = 0;
                var countGMedia = 0;
                var maiorValor = -1;

                for (let i = 0; i < answerList.length; i++) {
                    sum += Number(answerList[i]);
                }
                media = sum / answerList.length;
                for (let i = 0; i < answerList.length; i++) {
                    if (answerList[i] > media) {
                        countGMedia += 1;
                    }
                }
                for (let i = 0; i < answerSet.length; i++) {
                    if (answerSet[i] > maiorValor) {
                        maiorValor = answerSet[i];
                    }
                }

                var porcentG = counter[gIndice] / answerList.length * 100;
                var porcentM = counter[mIndice] / answerList.length * 100;

                //progressPorcen1 = (media / maiorValor * 100).toFixed(2);
                progressPorcen1 = porcentG.toFixed(2);

                titleProgressBar1 = `A média foi ${media.toFixed(0)}`;
                textProgressBar1 = `O ano em que a maioria dos alunos nasceu foi ${answerList[gIndice]}, que é ${progressPorcen1}% do total`;

                progressPorcen2 = (countGMedia / answer[q].length * 100).toFixed(2);
                titleProgressBar2 = `${countGMedia} nasceram depois do ano ${media.toFixed(0)}`;
                textProgressBar2 = `Porcentagem de alunos que nasceu depois do ano da média foi de ${progressPorcen2}%`;

            } else if (questionClass === "num") {

                var gValue = -1;
                var mValue = 1000;
                var gIndice = -1;
                var mIndice = -1;
                for (let i = 0; i < answerCounter[q].length; i++) {
                    if (answerCounter[q][i] > gValue) {
                        gValue = answerCounter[q][i];
                        gIndice = i;
                    }
                    if (answerCounter[q][i] < mValue) {
                        mValue = answerCounter[q][i];
                        mIndice = i;
                    }
                }

                var media = 0;
                var sum = 0;
                var countGMedia = 0;
                var maiorValor = -1;

                for (let i = 0; i < answer[q].length; i++) {
                    sum += answer[q][i];
                }
                media = sum / answer[q].length;
                for (let i = 0; i < answer[q].length; i++) {
                    if (answer[q][i] > media) {
                        countGMedia += 1;
                    }
                }
                for (let i = 0; i < setAnswer[q].length; i++) {
                    if (setAnswer[q][i] > maiorValor) {
                        maiorValor = setAnswer[q][i];
                    }
                }

                var porcentG = answerCounter[q][gIndice] / answer[q].length * 100;
                var porcentM = answerCounter[q][mIndice] / answer[q].length * 100;

                progressPorcen1 = (media / maiorValor * 100).toFixed(2);
                titleProgressBar1 = `A média é ${media.toFixed(2)}`;
                textProgressBar1 = `A média é ${progressPorcen1}% da resposta com o maior valor (${maiorValor})`;

                progressPorcen2 = (countGMedia / answer[q].length * 100).toFixed(2);
                titleProgressBar2 = `${countGMedia} foram maior que a média`;
                textProgressBar2 = `Porcentagem de alunos maior que a média foi de ${progressPorcen2}%`;


            } else if (questionClass === "aux") {
                //tableAllAnswerSet;
                //tableAllAnswerCounter;

                var gValue = -1;
                var mValue = 1000;
                var gIndice = -1;
                var mIndice = -1;
                for (let i = 0; i < tableAllAnswerCounter.length; i++) {
                    if (tableAllAnswerCounter[i] > gValue) {
                        gValue = tableAllAnswerCounter[i];
                        gIndice = i;
                    }
                    if (tableAllAnswerCounter[i] < mValue) {
                        mValue = tableAllAnswerCounter[i];
                        mIndice = i;
                    }
                }

                var porcentG = tableAllAnswerCounter[gIndice] / answer[q].length * 100;
                var porcentM = tableAllAnswerCounter[mIndice] / answer[q].length * 100;

                titleProgressBar1 = `Mais respondido: ${tableAllAnswerSet[gIndice]}`;
                titleProgressBar2 = `Menos respondido: ${tableAllAnswerSet[mIndice]}`;
                textProgressBar1 = `${tableAllAnswerCounter[gIndice]} Alunos (${porcentG.toFixed(2)}%)`;
                textProgressBar2 = `${tableAllAnswerCounter[mIndice]} Alunos (${porcentM.toFixed(2)}%)`;
                progressPorcen1 = porcentG.toFixed(2);
                progressPorcen2 = porcentM.toFixed(2);

            }

            for (let i = 0; i < answerCounter[q].length; i++) {
                if (answerCounter[q][i] > gValue) {
                    gValue = answerCounter[q][i];
                    gIndice = i;
                }
                if (answerCounter[q][i] < mValue) {
                    mValue = answerCounter[q][i];
                    mIndice = i;
                }
            }

            //var porcentG = answerCounter[q][gIndice] / answer[q].length * 100;
            //var porcentM = answerCounter[q][mIndice] / answer[q].length * 100;

            console.log(questionClass);
            var insertDivP1 = document.createElement('div');
            insertDivP1.setAttribute('class', 'progress-box progress-1');
            insertDivP1.innerHTML = `   <h4 class="por-title">${titleProgressBar1}</h4>
                                            <div class="por-txt">${textProgressBar1}</div>
                                            <div class="progress mb-2" style="height: 5px;">
                                                <div class="progress-bar bg-flat-color-1" role="progressbar"
                                                    style="width: ${progressPorcen1}%;" aria-valuenow="25" aria-valuemin="0"
                                                    aria-valuemax="100"></div>
                                            </div>`
            var insertDivP2 = document.createElement('div');
            insertDivP2.setAttribute('class', 'progress-box progress-2');
            insertDivP2.innerHTML = `<h4 class="por-title">${titleProgressBar2}</h4>
                                            <div class="por-txt">${textProgressBar2}</div>
                                            <div class="progress mb-2" style="height: 5px;">
                                                <div class="progress-bar bg-flat-color-2" role="progressbar"
                                                    style="width: ${progressPorcen2}%;" aria-valuenow="25" aria-valuemin="0"
                                                    aria-valuemax="100">
                                                </div>
                                            </div>`;

            document.getElementById(`${nameGraph}progress`).prepend(insertDivP2);
            document.getElementById(`${nameGraph}progress`).prepend(insertDivP1);
        }
        function createTable(nameGraph, answersList) {
            //Cria tabela para perguntas que ficam ruins com gráficos                    
            var nameTable = "bootstrapTable" + nameGraph;
            var dataTable = `<table id="${nameTable}" class="table table-striped table-bordered">`;


            dataTable = dataTable + `<thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Resposta</th>
                                    </tr>
                                </thead>`;

            dataTable = dataTable + "<tbody>";

            //var tableAllAnswerSet = new Array(1);

            for (let i = 0; i < answersList.length; i++) {
                dataTable = dataTable + `<tr><td>${i + 1}</td><td>${answersList[i]}</td></tr>`;
                //Caso a resposta for do tipo checker, poderá ser selecionada mais de uma resposta
                //Contar as respostas repetidas
                answersList[i] = answersList[i].toString();
                if (answersList[i].indexOf(",") >= 0 && (questionClass !== "aberta")) {
                    questionClass = "aux";
                    let charArray = answersList[i].split(",");
                    for (let j = 0; j < charArray.length; j++) {
                        if (charArray[j][0] == " ") {
                            charArray[j] = charArray[j].slice(1);
                        }
                        tableAllAnswer.push(charArray[j]);
                    }
                }
            }
            dataTable = dataTable + "</tbody></table>";
            document.getElementById(`divCanvas${nameGraph}`).innerHTML = dataTable;

            tableAllAnswerSet = [...new Set(tableAllAnswer)];
            tableAllAnswerCounter = new Array(tableAllAnswerSet.length);
            for (let j = 0; j < tableAllAnswerSet.length; j++) {
                tableAllAnswerCounter[j] = 0;
            }
            for (let i = 0; i < tableAllAnswer.length; i++) {
                for (let j = 0; j < tableAllAnswerSet.length; j++) {
                    if (tableAllAnswer[i] === tableAllAnswerSet[j]) {
                        tableAllAnswerCounter[j] += 1;
                    }
                }
            }

            if (questionClass === "aux") {

                var insertDivAux = document.createElement('div');
                insertDivAux.setAttribute('id', `divCanvasAux${nameGraph}`);
                insertDivAux.innerHTML = `<div id="divCanvasAux${nameGraph}"></div>`;
                document.getElementById(`${nameGraph}progress`).append(insertDivAux);

                var pieChartDataset = createDataset(tableAllAnswerSet, "Blank", tableAllAnswerCounter);
                createChartjs(`Aux${nameGraph}`, pieChartDataset, "pie");
            }
            (function ($) {
                $(`#${nameTable}`).DataTable();
            }(jQuery));
        }
        function createDataset(setAns, quest, answerC) {
            console.log("createDataset");
            var charDataset = {
                labels: setAns,
                datasets: [{
                    label: quest,
                    borderColor: colorBlue,
                    borderWidth: "2",
                    backgroundColor: setColors,
                    data: answerC
                }]
            }
            return charDataset;
        }
        function addDataset(chartDataset, quest, answerC) {
            var newDataset = {
                label: quest,
                borderColor: colorBlue,
                borderWidth: "2",
                backgroundColor: setColors,
                data: answerC
            }
            chartDataset.datasets.push(newDataset);
        }
        function createChartjs(nameGraph, chartDataset, graphType) {

            let heightVar = 100;
            let legendPos = 'top';
            console.log(`divCanvas${nameGraph}`);
            let auxTest = nameGraph.substring(0, 3)
            console.log(auxTest)
            if (auxTest.toLowerCase() === "aux") {
                heightVar = 100;
                legendPos = 'right'
            }

            document.getElementById(`divCanvas${nameGraph}`).innerHTML = `<canvas id=${nameGraph}></canvas>`
            var ctx = document.getElementById(nameGraph);
            ctx.height = heightVar;
            var myChart = new Chart(ctx, {
                type: graphType,
                data: chartDataset,
                options: {
                    legend: {
                        display: true,
                        position: legendPos
                    },
                    scales: {
                        xAxes: [{
                            ticks: {
                                display: false //Tira o label do eixo x
                            }
                        }]
                    },
                    responsive: true,
                    tooltips: {
                        mode: 'index',
                        intersect: false
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    }
                }
            });
        }
        function ExcelDateToJSDate(serial) {
            var utc_days = Math.floor(serial - 25568);
            var utc_value = utc_days * 86400;
            var date_info = new Date(utc_value * 1000);
            var fractional_day = serial - Math.floor(serial) + 0.0000001;
            var total_seconds = Math.floor(86400 * fractional_day);
            var seconds = total_seconds % 60;
            total_seconds -= seconds;
            var hours = Math.floor(total_seconds / (60 * 60));
            var minutes = Math.floor(total_seconds / 60) % 60;
            return new Date(date_info.getFullYear(), date_info.getMonth(), date_info.getDate(), hours, minutes, seconds);
        }
        function correlation() {
            //correlacionar gráficos
        }
        function createGraphs() {
            console.log("hi3");
            (function ($) {
                //spanTotalPerguntas

                document.getElementById('divChart').innerHTML = "";//limpar gráficos
                document.getElementById("spanTotalPerguntas").innerHTML = question.length - 1;
                document.getElementById("spanTotalAlunos").innerHTML = answer[0].length;

                let nameGraph = "ChartTeste";

                for (let i = 1; i < question.length; i++) {
                    //console.log(checkList[i]);
                    if (checkList[i]) {
                        createQuestionGraph(nameGraph + i, i, "auto");
                    }
                }
            }(jQuery));
        }
    </script>
</body>

</html>